# 画面フロー

このドキュメントでは、MVPにおける画面遷移フローについて説明します。

## 全体画面フロー図

```
+----------------+     +----------------+     +----------------+
|  ログイン画面   |---->|  ユーザー登録   |---->|  パスワード    |
+----------------+     +----------------+     |  リセット      |
        |                                     +----------------+
        v
+----------------+
|    ダッシュ     |
|    ボード       |
+----------------+
        |
        |--------------------+--------------------+
        v                    v                    v
+----------------+   +----------------+   +----------------+
|   問題一覧      |   |   学習進捗     |   |   プロフィール  |
+----------------+   +----------------+   +----------------+
        |
        v
+----------------+
|   問題詳細      |
+----------------+
        |
        v
+----------------+
|   回答確認      |
+----------------+
```

## 画面ごとの詳細

### 1. ログイン画面

- **URL**: `/login`
- **概要**: システムへのログイン画面
- **主要コンポーネント**:
  - メールアドレス入力フィールド
  - パスワード入力フィールド
  - ログインボタン
  - 新規登録リンク
  - パスワードリセットリンク
- **主要機能**:
  - 認証トークンの取得と保存
  - 認証エラーメッセージの表示
- **遷移先**:
  - 認証成功: ダッシュボード
  - 新規登録: ユーザー登録画面
  - パスワードリセット: パスワードリセット画面

### 2. ユーザー登録画面

- **URL**: `/register`
- **概要**: 新規ユーザーの登録画面
- **主要コンポーネント**:
  - メールアドレス入力フィールド
  - パスワード入力フィールド
  - パスワード確認フィールド
  - 氏名入力フィールド
  - ロール選択（学生/教員）
  - 登録ボタン
  - ログイン画面へのリンク
- **主要機能**:
  - 入力データのバリデーション
  - ユーザー登録APIの呼び出し
  - 登録完了メッセージの表示
- **遷移先**:
  - 登録成功: ログイン画面
  - ログインリンク: ログイン画面

### 3. パスワードリセット画面

- **URL**: `/reset-password`
- **概要**: パスワードリセットのメール送信画面
- **主要コンポーネント**:
  - メールアドレス入力フィールド
  - リセットリクエストボタン
  - ログイン画面へのリンク
- **主要機能**:
  - パスワードリセットメールの送信
  - 確認メッセージの表示
- **遷移先**:
  - メール送信後: ログイン画面
  - ログインリンク: ログイン画面

### 4. ダッシュボード

- **URL**: `/dashboard`
- **概要**: ログイン後のメインダッシュボード
- **主要コンポーネント**:
  - ナビゲーションメニュー
  - 学習進捗サマリー
  - 最近の活動履歴
  - 推奨問題リスト
  - クイックアクションボタン
- **主要機能**:
  - ユーザーの活動概要の表示
  - 学習統計の視覚化
  - クイックアクセスリンク
- **遷移先**:
  - 問題一覧: 問題一覧画面
  - 学習進捗: 学習進捗画面
  - プロフィール: プロフィール画面
  - 推奨問題: 問題詳細画面

### 5. 問題一覧画面

- **URL**: `/problems`
- **概要**: 利用可能な問題の一覧表示
- **主要コンポーネント**:
  - 問題リスト
  - フィルタリングオプション
  - ソートオプション
  - ページネーション
  - 問題作成ボタン（教員のみ）
- **主要機能**:
  - 問題の一覧表示
  - カテゴリ・タグによるフィルタリング
  - 難易度・日付によるソート
  - 問題作成フォームの表示（教員のみ）
- **遷移先**:
  - 問題クリック: 問題詳細画面
  - 新規問題作成: 問題作成フォーム（教員のみ）

### 6. 問題詳細画面

- **URL**: `/problems/{problem_id}`
- **概要**: 個別の問題の詳細表示と回答フォーム
- **主要コンポーネント**:
  - 問題タイトル
  - 問題説明
  - 問題文（LaTeX数式レンダリング）
  - 選択肢リスト
  - 回答送信ボタン
  - 問題編集ボタン（教員のみ）
- **主要機能**:
  - 問題内容の表示
  - LaTeX数式のレンダリング
  - 選択肢の選択と送信
  - 問題編集フォームの表示（教員のみ）
- **遷移先**:
  - 回答送信: 回答確認画面
  - 編集完了: 問題詳細画面（更新後）

### 7. 回答確認画面

- **URL**: `/problems/{problem_id}/answer`
- **概要**: 問題回答後のフィードバック表示
- **主要コンポーネント**:
  - 正誤結果表示
  - フィードバックメッセージ
  - 正解と解説（LaTeX対応）
  - 次の推奨問題へのリンク
  - 問題一覧へのリンク
- **主要機能**:
  - 回答結果の表示
  - 詳細な解説の提供
  - 学習進捗の更新表示
- **遷移先**:
  - 次の問題: 問題詳細画面（別問題）
  - 問題一覧: 問題一覧画面

### 8. 学習進捗画面

- **URL**: `/progress`
- **概要**: ユーザーの学習進捗詳細
- **主要コンポーネント**:
  - 総合学習統計
  - 分野別進捗グラフ
  - 時系列学習活動チャート
  - 弱点分野ハイライト
- **主要機能**:
  - 学習データの視覚化
  - 期間別フィルタリング
  - カテゴリ別進捗表示
- **遷移先**:
  - 推奨問題: 問題詳細画面
  - 弱点分野の問題: 問題一覧画面（フィルタリング済み）

### 9. プロフィール画面

- **URL**: `/profile`
- **概要**: ユーザープロフィール情報と設定
- **主要コンポーネント**:
  - プロフィール情報表示
  - 編集フォーム
  - アカウント設定
  - ログアウトボタン
- **主要機能**:
  - プロフィール情報の表示と編集
  - パスワード変更
  - アカウント設定の管理
- **遷移先**:
  - ログアウト: ログイン画面
  - 設定保存: プロフィール画面（更新後）

## 教員向け追加画面

### 10. 問題作成/編集画面

- **URL**: `/problems/create` または `/problems/{problem_id}/edit`
- **概要**: 問題の作成・編集フォーム（教員のみ）
- **主要コンポーネント**:
  - 問題タイトル入力
  - 問題説明入力
  - 問題文エディタ（LaTeX対応）
  - 選択肢追加フォーム
  - タグ追加機能
  - 難易度設定スライダー
  - 保存・公開ボタン
- **主要機能**:
  - 問題情報の入力と編集
  - LaTeX数式のリアルタイムプレビュー
  - 複数選択肢の管理
  - タグとカテゴリの設定
- **遷移先**:
  - 保存完了: 問題詳細画面
  - キャンセル: 問題一覧画面または問題詳細画面

## ユーザーロールごとの画面アクセス

| 画面 | 学生 | 教員 |
|------|-----|------|
| ログイン | ✓ | ✓ |
| ユーザー登録 | ✓ | ✓ |
| パスワードリセット | ✓ | ✓ |
| ダッシュボード | ✓ | ✓ |
| 問題一覧 | ✓ | ✓ |
| 問題詳細 | ✓ | ✓ |
| 回答確認 | ✓ | ✓ |
| 学習進捗 | ✓ | ✓ |
| プロフィール | ✓ | ✓ |
| 問題作成/編集 | ✗ | ✓ |
